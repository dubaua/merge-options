{"version":3,"file":"merge-options.min.umd.js","sources":["../src/utils/hasProperty.js","../src/utils/isObject.js","../src/merge-options.js","../src/index.js"],"sourcesContent":["function hasProperty(object, property) {\n  return Object.prototype.hasOwnProperty.call(object, property);\n}\n\nexport default hasProperty;\n","function isObject(value) {\n  return value !== null && typeof value === 'object' && Array.isArray(value) === false;\n}\n\nexport default isObject;\n","import hasProperty from '@/utils/hasProperty.js';\n\n/**\n * @typedef {Object} Option\n * @property {boolean|function} [required] - a flag or function accepts userOptions\n * @property {*} [default] - default value for fallback if user option fail validation\n * @property {function} validator - function for validating user option. Accepts userValue as first argument and userOptions as second. Should return boolean value\n * @property {string} description - human readable validator description. Uses to compose an error message and warning\n */\n\n/**\n * Uses option configuration to iterate over passed user options.\n * Returns an object with user options passed validation and/or default not required values.\n * Throws an error for every missing required option.\n * Fallback to default value to every not required option.\n * If user value fails validation throws an error in strict mode or otherwise shows a warning message and fallback to default value.\n * All errors and warnings are verbose and composed based on description of options.\n * @param {Object} config - required configuration\n * @param {Object.<string, Option>} config.optionConfig - declarative option configuration\n * @param {Object} [config.userOptions={}] - user options needs validation before merge\n * @param {string} [config.prefix=''] - string before an error or warning message\n * @param {string} [config.suffix=''] - string after an error or warning message\n * @param {boolean} [config.strict=true] - strict mode flag. Default = true.\n * In strict mode the function throws an error, when user option fails validation.\n * Otherwise the function shows warning message and fallback to default value.\n * @return {Object} an object with all keys described in options with userOption values if they pass validation and/or default not required values.\n */\n\nfunction _mergeOptions({ optionConfig, userOptions = {}, prefix = '', suffix = '', strict = true }) {\n  const createMessage = (message) => [prefix, message, suffix].join(' ');\n\n  const mergedOptions = {};\n\n  // iterate over optionConfig to merge only options described in config\n  for (const optionKey in optionConfig) {\n    if (hasProperty(optionConfig, optionKey)) {\n      const optionPropertyConfig = optionConfig[optionKey];\n      const { required, default: _default, description, validator } = optionPropertyConfig;\n      const userValue = userOptions[optionKey];\n\n      // required can be function\n      const isRequired = hasProperty(optionPropertyConfig, 'required')\n        ? typeof required === 'function'\n          ? required(userOptions)\n          : required\n        : false;\n\n      const isUserOptionPassed = hasProperty(userOptions, optionKey);\n\n      const isValid = validator(userValue, userOptions);\n\n      if (isRequired) {\n        if (isUserOptionPassed) {\n          if (isValid) {\n            mergedOptions[optionKey] = userValue;\n          } else {\n            throw new TypeError(\n              createMessage(`Expected ${optionKey} to be ${description}, got ${typeof userValue} ${userValue}.`),\n            );\n          }\n        } else {\n          throw new TypeError(createMessage(`${optionKey} is required.`));\n        }\n      } else {\n        mergedOptions[optionKey] = _default;\n        if (isUserOptionPassed) {\n          if (isValid) {\n            mergedOptions[optionKey] = userValue;\n          } else {\n            if (strict) {\n              throw new TypeError(\n                createMessage(`Expected ${optionKey} to be ${description}, got ${typeof userValue} ${userValue}.`),\n              );\n            } else {\n              console.warn(\n                createMessage(\n                  `Expected ${optionKey} to be ${description}, got ${typeof userValue} ${userValue}. Fallback to default value ${_default}.`,\n                ),\n              );\n            }\n          }\n        }\n      }\n    }\n  }\n\n  return mergedOptions;\n}\n\nexport default _mergeOptions;\n","import hasProperty from '@/utils/hasProperty.js';\nimport isObject from '@/utils/isObject.js';\nimport _mergeOptions from '@/merge-options.js';\n\nconst MESSAGE_PREFIX = '[mergeOptions]:';\nconst MESSAGE_SUFFIX = '\\nCheck out documentation https://github.com/dubaua/merge-options#parameters-and-return';\n\nfunction throwTypeError(message) {\n  throw new TypeError([MESSAGE_PREFIX, message, MESSAGE_SUFFIX].join(' '));\n}\n\nfunction optionConfigValidator(optionConfig) {\n  for (const key in optionConfig) {\n    if (hasProperty(optionConfig, key)) {\n      const optionPropertyConfig = optionConfig[key];\n\n      if (!isObject(optionPropertyConfig)) {\n        throwTypeError(\n          `Expected optionConfig.${key} to be an object with declarative option configuration, got ${typeof optionPropertyConfig} ${optionPropertyConfig}.`,\n        );\n      }\n\n      if (hasProperty(optionPropertyConfig, 'required')) {\n        const required = optionPropertyConfig.required;\n        const requiredType = typeof required;\n        if (!(requiredType === 'boolean' || requiredType === 'function')) {\n          throwTypeError(\n            `Expected optionConfig.${key}.required to be either boolean or function, got ${typeof required} ${required}.`,\n          );\n        }\n      } else {\n        if (!hasProperty(optionPropertyConfig, 'default')) {\n          throwTypeError(`Expected optionConfig.${key} to either have required or default value.`);\n        }\n      }\n\n      if (!hasProperty(optionPropertyConfig, 'default') && !hasProperty(optionPropertyConfig, 'required')) {\n        throwTypeError(`Expected optionConfig.${key} to either have required or default value.`);\n      }\n\n      if (hasProperty(optionPropertyConfig, 'description')) {\n        const description = optionPropertyConfig.description;\n        if (typeof optionPropertyConfig.description !== 'string') {\n          throwTypeError(\n            `Expected optionConfig.${key}.description to be a string, got ${typeof description} ${description}.`,\n          );\n        }\n      } else {\n        throwTypeError(`Missing description on optionConfig.${key} config.`);\n      }\n\n      if (hasProperty(optionPropertyConfig, 'validator')) {\n        const validator = optionPropertyConfig.validator;\n        if (typeof optionPropertyConfig.validator !== 'function') {\n          throwTypeError(\n            `Expected optionConfig.${key}.validator to be a function, got ${typeof validator} ${validator}.`,\n          );\n        }\n      } else {\n        throwTypeError(`Missing validator on optionConfig.${key} config.`);\n      }\n    }\n  }\n  return isObject(optionConfig);\n}\n\nconst OPTION_CONFIG = {\n  optionConfig: {\n    required: true,\n    validator: optionConfigValidator,\n    description: 'an object with declarative option configuration',\n  },\n  userOptions: {\n    required: false,\n    default: {},\n    validator: isObject,\n    description: 'an object',\n  },\n  prefix: {\n    required: false,\n    default: '',\n    validator: (x) => typeof x === 'string',\n    description: 'a string',\n  },\n  suffix: {\n    required: false,\n    default: '',\n    validator: (x) => typeof x === 'string',\n    description: 'a string',\n  },\n  strict: {\n    required: false,\n    default: true,\n    validator: (x) => typeof x === 'boolean',\n    description: 'a boolean',\n  },\n};\n\n/**\n * @typedef {Object} Option\n * @property {boolean|function} [required] - a flag or function accepts userOptions\n * @property {*} [default] - default value for fallback if user option fail validation\n * @property {function} validator - function for validating user option. Accepts userValue as first argument and userOptions as second. Should return boolean value\n * @property {string} description - human readable validator description. Uses to compose an error message and warning\n */\n\n/**\n * Uses option configuration to iterate over passed user options.\n * Returns an object with user options passed validation and/or default not required values.\n * Throws an error for every missing required option.\n * Fallback to default value to every not required option.\n * If user value fails validation throws an error in strict mode or otherwise shows a warning message and fallback to default value.\n * All errors and warnings are verbose and composed based on description of options.\n * @param {Object} config - required configuration\n * @param {Object.<string, Option>} config.optionConfig - declarative option configuration\n * @param {Object} [config.userOptions={}] - user options needs validation before merge\n * @param {string} [config.prefix=''] - string before an error or warning message\n * @param {string} [config.suffix=''] - string after an error or warning message\n * @param {boolean} [config.strict=true] - strict mode flag. Default = true\n * In strict mode the function throws an error, when user option fails validaton.\n * Otherwise the function shows warning message and fallback to default value.\n * @return {Object} an object with all keys described in options with userOption values if they pass validation and/or default not required values.\n */\n\nfunction mergeOptions(config) {\n  const validConfig = _mergeOptions({\n    optionConfig: OPTION_CONFIG,\n    userOptions: config,\n    prefix: MESSAGE_PREFIX,\n    suffix: MESSAGE_SUFFIX,\n  });\n  return _mergeOptions(validConfig);\n}\n\nexport default mergeOptions;\n"],"names":["hasProperty","object","property","Object","prototype","hasOwnProperty","call","isObject","value","Array","isArray","_mergeOptions","_ref","optionConfig","_ref$userOptions","userOptions","_ref$prefix","prefix","_ref$suffix","suffix","_ref$strict","strict","createMessage","message","join","mergedOptions","optionKey","optionPropertyConfig","required","_default","description","validator","userValue","isRequired","isUserOptionPassed","isValid","TypeError","console","warn","MESSAGE_PREFIX","MESSAGE_SUFFIX","throwTypeError","OPTION_CONFIG","key","requiredType","default","x","config","validConfig"],"mappings":"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"}